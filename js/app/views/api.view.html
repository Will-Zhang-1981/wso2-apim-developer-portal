<div class="jumbotron title">
  <div class="container" style="padding-left: 0">
    <h1>{{vm.apiName}} {{vm.apiVersion}}</h1>
  </div>
</div>

<div class="container">
  <!--<h1 class="sub-header">{{vm.api.name}} - v.{{vm.api.version}}</h1>-->

  <div class="row col-md-2">
    <!--Image-->
    <img src="{{vm.api.imageUrl}}" alt="image..." style="width: 80%;" />
  </div>

  <div class="row col-md-6">
    <div class="row">
      <label for="version" class="col-xs-4 col-md-3">Version:</label>
      <div id="version" class="col-xs-8 col-md-9">{{vm.api.version}}</div>
    </div>

    <div class="row">
      <label for="status" class="col-xs-4 col-md-3">Status:</label>
      <div class="col-xs-8 col-md-9">{{vm.api.status}}</div>
    </div>
  </div>

  <div ng-show="!user.loggedIn" class="row col-md-4">
    <div class="alert alert-warning" role="alert">
      <span class="glyphicon glyphicon-info-sign">&nbsp;</span>Logga in för att kunna prenumerera på detta API!
    </div>
  </div>

  <div ng-show="(user.loggedIn)" class="row col-md-4 well">
    <div class="form-group" ng-class="{ 'has-error': addSubscriptionForm.application.$dirty && addSubscriptionForm.application.$invalid, 'has-success' : addSubscriptionForm.application.$valid}">
      <div ng-show="!vm.applications.length">
        Du har inga registrerade applikationer.
        <br />
        <a href="#/applications">Skapa en applikation först</a>, skapa sedan en prenumeration här!
      </div>

      <div ng-show="vm.applications.length">
        <form name="addSubscriptionForm" ng-submit="vm.addSubscription()" role="form" class="ng-pristine ng-invalid ng-invalid-required">
          <input type="hidden" name="apiId" ng-model="vm.apiId" value="{{vm.apiId}}" />
          <div class="form-group" ng-class="{ 'has-error': addSubscriptionForm.application.$dirty && addSubscriptionForm.application.$invalid, 'has-success' : addSubscriptionForm.application.$valid}">
            <label for="application">Applikation</label>
            <select name="application" id="application" ng-model="vm.selectedApplicationId" class="form-control" required>
              <option ng-repeat="entry in vm.applications" value="{{entry.id}}">{{entry.name}}</option>
            </select>
            <span ng-show="addSubscriptionForm.application.$dirty && addSubscriptionForm.application.$error.required" class="help-block">Applikation är obligatoriskt</span>
          </div>
          <div class="form-actions noclick">
            <button type="submit" ng-disabled="addSubscriptionForm.$invalid || vm.dataLoading" class="btn btn-primary" disabled="disabled">Skapa prenumeration</button>
            <img ng-if="vm.dataLoadingAddApplication" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="
            />
            <span ng-click="vm.resetAddSubscriptionForm()" class="btn btn-link">Ångra</span>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="row col-md-12">
    <div class="card">
      <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active">
          <a href="#apiOverview" target="_self" aria-controls="home" role="tab" data-toggle="tab">Översikt</a>
        </li>
        <li role="presentation">
          <a href="#apiDocs" target="_self" aria-controls="profile" role="tab" data-toggle="tab">Dokumentation</a>
        </li>
        <li role="presentation">
          <a href="#apiConsole" target="_self" aria-controls="messages" role="tab" data-toggle="tab">API-konsol</a>
        </li>
      </ul>

      <!-- Tab panes -->
      <div class="tab-content">

        <div role="tabpanel" class="tab-pane active" id="apiOverview">

          <h3>Beskrivning</h3>
          <div id="desc" ng-bind-html="vm.api.description"></div>

          <h3>URL</h3>
          <div id="url">https://api.vasttrafik.se/{{vm.api.version + vm.api.context}}</div>
        </div>

        <div role="tabpanel" class="tab-pane" id="apiDocs">

          <table class="table table-hover table-striped" ng-show="vm.documents.length > 0">
            <thead class="table-header">
              <tr>
                <th>Namn</th>
                <th>Beskrivning</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="doc in vm.documents" class="nga-default nga-fade">
                <td>
                  <span><a href="{{doc.url}}" title="{{doc.type}}">{{doc.name}}</a></span>
                </td>
                <td>
                  <span>{{doc.summary}}</span>
                </td>
              </tr>
            </tbody>
          </table>

          <div ng-show="!(vm.documents.length > 0)" class="alert alert-warning" role="alert">
            <span class="glyphicon glyphicon-info-sign">&nbsp;</span>Det finns inga dokument associerade till detta API!
          </div>
        </div>

        <div role="tabpanel" class="tab-pane" id="apiConsole">
          <!-- No token requirement yet. -->
          <!--<div ng-if="!user.loggedIn" class="alert alert-warning">
            <span class="glyphicon glyphicon-info-sign">&nbsp;</span>Du behöver ett access token för att testa detta API. Var vänlig logga in och prenumerera på API
            för att generera ett access token. Om du redan har ett token, var vänlig ange det nedan.
          </div>
          <label for="requestHeader">Ange Request Header</label>
          <div class="input-group">
            <span class="input-group-addon" id="basic-addon3">Authorization: Bearer </span>
            <input type="text" class="form-control" id="requestHeader" aria-describedby="basic-addon3">
          </div>-->

          <div class="row" style="padding:20px;">
            <div swagger-ui url="vm.swaggerUrl" api-explorer="true" parser="json"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
